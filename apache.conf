<VirtualHost *:80>
    ServerName tu-dominio.com
    DocumentRoot /var/www/splicedd
    
    # Enable proxy module
    LoadModule proxy_module modules/mod_proxy.so
    LoadModule proxy_http_module modules/mod_proxy_http.so
    LoadModule rewrite_module modules/mod_rewrite.so
    
    # Enable CORS
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization"
    
    # Proxy for GraphQL API
    ProxyPass /api/graphql https://surfaces-graphql.splice.com/graphql
    ProxyPassReverse /api/graphql https://surfaces-graphql.splice.com/graphql
    ProxyPreserveHost Off
    
    # Proxy for S3 files
    ProxyPass /api/s3/ https://spliceproduction.s3.us-west-1.amazonaws.com/
    ProxyPassReverse /api/s3/ https://spliceproduction.s3.us-west-1.amazonaws.com/
    
    # SPA routing
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]
    
    ErrorLog ${APACHE_LOG_DIR}/splicedd_error.log
    CustomLog ${APACHE_LOG_DIR}/splicedd_access.log combined
</VirtualHost>